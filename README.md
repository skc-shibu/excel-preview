# Excel ファイルビューア - SpreadJS

このプロジェクトは、React + TypeScript + SpreadJS を使用して、Excel ファイルをローカルからアップロードしてプレビューを表示する Web アプリケーションです。

## 機能

- 📊 **Excel ファイルのアップロード**: `.xlsx`, `.xls`, `.csv` ファイルをサポート
- 🔍 **リアルタイムプレビュー**: SpreadJS を使用した高性能なスプレッドシート表示
- 📱 **レスポンシブデザイン**: モバイルデバイスにも対応
- ⚡ **高速処理**: クライアントサイドでのファイル処理
- 🔒 **プライベート**: ファイルはローカルで処理され、サーバーに送信されません
- 🌐 **GitHub Pages 対応**: オンラインで直接利用可能
- 🔧 **JSON 変換**: Excel ファイルを JSON 形式で出力・確認可能
- 📊 **差分比較**: 2 つの Excel ファイルの差分を視覚的に表示

## ライブデモ

🌐 **[デモサイトを見る](https://skc-shibu.github.io/excel-preview)**

## 技術スタック

- **React 18** - ユーザーインターフェイス
- **TypeScript** - 型安全性
- **SpreadJS** - スプレッドシート表示エンジン
- **CSS3** - スタイリング

## セットアップ手順

### 1. 依存関係のインストール

```bash
npm install
```

### 2. 開発サーバーの起動

```bash
npm start
```

ブラウザで [http://localhost:3000](http://localhost:3000) を開いてアプリケーションを確認できます。

### 3. ビルド（本番環境）

```bash
npm run build
```

### 4. GitHub Pages デプロイ

#### 初回設定

1. **`package.json`の`homepage`を確認**

   ```json
   "homepage": "https://skc-shibu.github.io/excel-preview"
   ```

   ✅ 既に設定済みです！

2. **必要なパッケージをインストール**

   ```bash
   npm install
   ```

#### デプロイ実行

```bash
npm run deploy
```

このコマンドにより、以下の処理が自動実行されます：

- アプリケーションのビルド（`npm run build`）
- `gh-pages`ブランチの作成・更新
- GitHub Pages への公開

#### GitHub リポジトリでの設定

1. GitHub リポジトリの **Settings** → **Pages** に移動
2. **Source** を **Deploy from a branch** に設定
3. **Branch** を **gh-pages** に設定
4. **Save** をクリック

数分後、指定した URL でアプリケーションが利用できるようになります。

## 使用方法

1. **ファイル選択**: 「📁 Excel ファイルを選択」ボタンをクリックして、Excel ファイルを選択します
2. **プレビュー**: 選択したファイルが自動的にプレビューエリアに表示されます
3. **ナビゲーション**: 複数のシートがある場合は、下部のタブでシートを切り替えできます
4. **リセット**: 「リセット」ボタンで新しいファイルを選択できます

## サポートファイル形式

- `.xlsx` - Excel 2007 以降
- `.xls` - Excel 97-2003
- `.csv` - カンマ区切り値

## プロジェクト構造

```
src/
├── components/
│   ├── ExcelViewer.tsx        # メインのビューアコンポーネント
│   ├── ExcelViewer.css        # ビューアのスタイル
│   ├── ExcelDiffViewer.tsx    # Excel差分比較コンポーネント
│   ├── ExcelDiffViewer.css    # 差分比較のスタイル
│   ├── ExcelToJsonViewer.tsx  # JSON変換コンポーネント
│   └── ExcelToJsonViewer.css  # JSON変換のスタイル
├── types/
│   └── diff.ts                # 差分比較の型定義
├── utils/
│   └── excelDiffUtils.ts      # 差分比較のユーティリティ
├── App.tsx                    # アプリケーションのルートコンポーネント
├── App.css                    # アプリケーションのスタイル
├── index.tsx                  # エントリーポイント
└── index.css                  # グローバルスタイル
```

## 注意事項

- SpreadJS は商用ライセンスが必要な場合があります
- 大きなファイル（10MB 以上）の処理には時間がかかる場合があります
- ブラウザのメモリ制限により、非常に大きなファイルは読み込めない場合があります

## トラブルシューティング

### ファイルが読み込めない場合

1. ファイル形式が対応しているか確認してください
2. ファイルが破損していないか確認してください
3. ブラウザを更新してもう一度お試しください

### 表示が崩れる場合

1. ブラウザのキャッシュをクリアしてください
2. 最新のブラウザを使用してください

## ライセンス

このプロジェクトは MIT ライセンスの下で公開されています。ただし、SpreadJS については別途ライセンスが必要です。
